package com.nripenTestApp;

import java.sql.SQLException;
import java.time.LocalDateTime;

import com.microsoft.azure.functions.ExecutionContext;
import com.microsoft.azure.functions.annotation.FunctionName;
import com.microsoft.azure.functions.annotation.TimerTrigger;

public class TmTrgFn_CostAndPerformanceTest {

	   /**
     * This function will be invoked periodically according to the specified schedule.
	 * @throws Exception 
     */
    @FunctionName("TmTrgFn_CostAndPerformanceTest")
    public void run(
        @TimerTrigger(name = "timerInfo1", schedule = "0/30 * * * * *") String timerInfo1,
        final ExecutionContext context
    ) throws Exception {
    	ServiceClass2 serviceClass2 = new ServiceClass2();
//    	try {
//			serviceClass2.sendEmail();	
//			context.getLogger().info("Email sent successfully!");
//		} catch (SQLException e) {
//			e.printStackTrace();
//			 context.getLogger().info("Error while sending email: "+e);
//		}
    	
		
		ServiceClass serviceClass = new ServiceClass();
		context.getLogger().info("Nripen's Java Timer trigger function timerInfo_CostAndPerformanceTest started at: "
				+ LocalDateTime.now());
		long start_time = System.currentTimeMillis();
		serviceClass.insertEmployee(1000);
		context.getLogger().info("Record inserted successfully!");
		/*
		 * serviceClass.updateAllEmployee();
		 * context.getLogger().info("Record updated successfully!");
		 */
		String s = serviceClass.selectAllEmployee();
		context.getLogger().info("Record selected successfully!");
		serviceClass.deleteAllEmployee();
		context.getLogger().info("Record deleted successfully!");
		long end_time = System.currentTimeMillis();
		long difference = end_time - start_time;
		context.getLogger().info("Nripen's Java Timer trigger function timerInfo_CostAndPerformanceTest ended at: "
				+ LocalDateTime.now());
		context.getLogger().info("Total time of execution: " + difference + " milliseconds.");
		 
//        context.getLogger().info("Nripen's Java Timer trigger function executed at: " + LocalDateTime.now());
    }

}
